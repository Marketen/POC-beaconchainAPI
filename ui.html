<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Beacon Validators UI</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    table { border-collapse: collapse; width: 100%; margin-top: 1em; }
    th, td { border: 1px solid #ccc; padding: 0.5em; text-align: left; }
    th { background: #f0f0f0; }
    .error { color: red; }
  </style>
</head>
<body>
  <h1>Beacon Validators</h1>
  <button onclick="loadValidators()">Refresh</button>
  <div id="error" class="error"></div>
  <table id="validators">
    <thead>
      <tr>
        <th>Index</th>
        <th>Balance</th>
        <th>Effective Balance</th>
        <th>Consensus (1d/7d/31d)</th>
        <th>Execution (1d/7d/31d)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <script>
    async function loadValidators() {
      document.getElementById('error').textContent = '';
      const tbody = document.querySelector('#validators tbody');
      tbody.innerHTML = '<tr><td colspan="5">Loading...</td></tr>';
      try {
        const res = await fetch('/validators');
        if (!res.ok) throw new Error('API error');
        const data = await res.json();
        tbody.innerHTML = '';
        if (Object.keys(data).length === 0) {
          tbody.innerHTML = '<tr><td colspan="5">No validators found.</td></tr>';
          return;
        }
        for (const idx in data) {
          const v = data[idx];
          tbody.innerHTML += `<tr>
            <td>${v.index}</td>
            <td>${v.balance}</td>
            <td>${v.effective_balance}</td>
            <td>${v.consensus ? `${v.consensus.performance1d} / ${v.consensus.performance7d} / ${v.consensus.performance31d}` : '-'}</td>
            <td>${v.execution ? `${v.execution.performance1d} / ${v.execution.performance7d} / ${v.execution.performance31d}` : '-'}</td>
          </tr>`;
        }
      } catch (e) {
        document.getElementById('error').textContent = e.message;
        tbody.innerHTML = '';
      }
    }
    loadValidators();
  </script>
</body>
</html>
